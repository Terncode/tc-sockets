"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.readAny = exports.readUint8Array = exports.readLength = exports.readObject = exports.readString = exports.readArray = exports.readBoolean = exports.readArrayBuffer = exports.readBytes = exports.readFloat64 = exports.readFloat32 = exports.readUint32 = exports.readInt32 = exports.readUint16 = exports.readInt16 = exports.readUint8 = exports.readInt8 = exports.getBinaryReaderBuffer = exports.createBinaryReaderFromBuffer = exports.createBinaryReader = void 0;
var utf8_1 = require("../common/utf8");
function createBinaryReader(buffer) {
    var view = new DataView(buffer.buffer, buffer.byteOffset, buffer.byteLength);
    var offset = 0;
    return { view: view, offset: offset };
}
exports.createBinaryReader = createBinaryReader;
function createBinaryReaderFromBuffer(buffer, byteOffset, byteLength) {
    var view = new DataView(buffer, byteOffset, byteLength);
    var offset = 0;
    return { view: view, offset: offset };
}
exports.createBinaryReaderFromBuffer = createBinaryReaderFromBuffer;
function getBinaryReaderBuffer(reader) {
    return new Uint8Array(reader.view.buffer, reader.view.byteOffset, reader.view.byteLength);
}
exports.getBinaryReaderBuffer = getBinaryReaderBuffer;
function readInt8(reader) {
    var offset = reader.offset;
    reader.offset += 1;
    return reader.view.getInt8(offset);
}
exports.readInt8 = readInt8;
function readUint8(reader) {
    var offset = reader.offset;
    reader.offset += 1;
    return reader.view.getUint8(offset);
}
exports.readUint8 = readUint8;
function readInt16(reader) {
    var offset = reader.offset;
    reader.offset += 2;
    return reader.view.getInt16(offset, true);
}
exports.readInt16 = readInt16;
function readUint16(reader) {
    var offset = reader.offset;
    reader.offset += 2;
    return reader.view.getUint16(offset, true);
}
exports.readUint16 = readUint16;
function readInt32(reader) {
    var offset = reader.offset;
    reader.offset += 4;
    return reader.view.getInt32(offset, true);
}
exports.readInt32 = readInt32;
function readUint32(reader) {
    var offset = reader.offset;
    reader.offset += 4;
    return reader.view.getUint32(offset, true);
}
exports.readUint32 = readUint32;
function readFloat32(reader) {
    var offset = reader.offset;
    reader.offset += 4;
    return reader.view.getFloat32(offset, true);
}
exports.readFloat32 = readFloat32;
function readFloat64(reader) {
    var offset = reader.offset;
    reader.offset += 8;
    return reader.view.getFloat64(offset, true);
}
exports.readFloat64 = readFloat64;
function readBytes(reader, length) {
    var offset = reader.offset;
    reader.offset += length;
    return new Uint8Array(reader.view.buffer, reader.view.byteOffset + offset, length);
}
exports.readBytes = readBytes;
function readArrayBuffer(reader) {
    var length = readLength(reader);
    if (length === -1)
        return null;
    var offset = reader.offset;
    reader.offset += length;
    return reader.view.buffer.slice(reader.view.byteOffset + offset, offset + length);
}
exports.readArrayBuffer = readArrayBuffer;
function readBoolean(reader) {
    return readUint8(reader) === 1;
}
exports.readBoolean = readBoolean;
function readArray(reader, readOne) {
    var length = readLength(reader);
    if (length === -1)
        return null;
    var result = [];
    for (var i = 0; i < length; i++) {
        result.push(readOne(reader));
    }
    return result;
}
exports.readArray = readArray;
function readString(reader) {
    var length = readLength(reader);
    if (length === -1)
        return null;
    var result = (0, utf8_1.decodeString)(reader.view, reader.offset, length);
    reader.offset += length;
    return result;
}
exports.readString = readString;
function readObject(reader, cloneTypedArrays) {
    if (cloneTypedArrays === void 0) { cloneTypedArrays = false; }
    return readAny(reader, [], cloneTypedArrays);
}
exports.readObject = readObject;
function readLength(reader) {
    var length = 0;
    var shift = 0;
    var b = 0;
    do {
        b = readUint8(reader);
        length = length | ((b & 0x7f) << shift);
        shift += 7;
    } while (b & 0x80);
    return length - 1;
}
exports.readLength = readLength;
function readUint8Array(reader) {
    var length = readLength(reader);
    if (length === -1)
        return null;
    return readBytes(reader, length);
}
exports.readUint8Array = readUint8Array;
function readShortLength(reader, length) {
    return length === 0x1f ? readLength(reader) : length;
}
function readAny(reader, strings, cloneTypedArrays) {
    var byte = readUint8(reader);
    var type = byte & 0xe0;
    var value = byte & 0x1f;
    switch (type) {
        case 0 /* Type.Special */:
            switch (value) {
                case 0 /* Special.Undefined */: return undefined;
                case 1 /* Special.Null */: return null;
                case 2 /* Special.True */: return true;
                case 3 /* Special.False */: return false;
                case 4 /* Special.Uint8Array */: {
                    var value_1 = readUint8Array(reader);
                    if (value_1 && cloneTypedArrays)
                        return value_1.slice();
                    return value_1;
                }
                default: throw new Error("Incorrect value (".concat(value, ", ").concat(byte, ")"));
            }
        case 32 /* Type.Number */:
            switch (value) {
                case 0 /* NumberType.Int8 */: return readInt8(reader);
                case 1 /* NumberType.Uint8 */: return readUint8(reader);
                case 2 /* NumberType.Int16 */: return readInt16(reader);
                case 3 /* NumberType.Uint16 */: return readUint16(reader);
                case 4 /* NumberType.Int32 */: return readInt32(reader);
                case 5 /* NumberType.Uint32 */: return readUint32(reader);
                case 6 /* NumberType.Float32 */: return readFloat32(reader);
                case 7 /* NumberType.Float64 */: return readFloat64(reader);
                default: throw new Error("Incorrect value (".concat(value, ", ").concat(byte, ")"));
            }
        case 160 /* Type.TinyPositiveNumber */:
            return value;
        case 192 /* Type.TinyNegativeNumber */:
            return -(value + 1);
        case 64 /* Type.String */: {
            var length_1 = readShortLength(reader, value);
            var result = (0, utf8_1.decodeString)(reader.view, reader.offset, length_1);
            reader.offset += length_1;
            strings.push(result);
            return result;
        }
        case 224 /* Type.StringRef */: {
            var index = readShortLength(reader, value);
            return strings[index];
        }
        case 96 /* Type.Array */: {
            var length_2 = readShortLength(reader, value);
            var array = [];
            for (var i = 0; i < length_2; i++) {
                array.push(readAny(reader, strings, cloneTypedArrays));
            }
            return array;
        }
        case 128 /* Type.Object */: {
            var length_3 = readShortLength(reader, value);
            var obj = {};
            for (var i = 0; i < length_3; i++) {
                var length_4 = readLength(reader);
                var key = void 0;
                if (length_4) {
                    key = (0, utf8_1.decodeString)(reader.view, reader.offset, length_4);
                    reader.offset += length_4;
                    strings.push(key);
                }
                else {
                    var index = readLength(reader);
                    key = strings[index];
                }
                obj[key] = readAny(reader, strings, cloneTypedArrays);
            }
            return obj;
        }
        default: throw new Error("Incorrect type (".concat(type, ", ").concat(byte, ")"));
    }
}
exports.readAny = readAny;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9wYWNrZXQvYmluYXJ5UmVhZGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLHVDQUE4QztBQVE5QyxTQUFnQixrQkFBa0IsQ0FBQyxNQUFrQjtJQUNwRCxJQUFNLElBQUksR0FBRyxJQUFJLFFBQVEsQ0FBQyxNQUFNLENBQUMsTUFBTSxFQUFFLE1BQU0sQ0FBQyxVQUFVLEVBQUUsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDO0lBQy9FLElBQU0sTUFBTSxHQUFHLENBQUMsQ0FBQztJQUNqQixPQUFPLEVBQUUsSUFBSSxNQUFBLEVBQUUsTUFBTSxRQUFBLEVBQUUsQ0FBQztBQUN6QixDQUFDO0FBSkQsZ0RBSUM7QUFFRCxTQUFnQiw0QkFBNEIsQ0FBQyxNQUFtQixFQUFFLFVBQWtCLEVBQUUsVUFBa0I7SUFDdkcsSUFBTSxJQUFJLEdBQUcsSUFBSSxRQUFRLENBQUMsTUFBTSxFQUFFLFVBQVUsRUFBRSxVQUFVLENBQUMsQ0FBQztJQUMxRCxJQUFNLE1BQU0sR0FBRyxDQUFDLENBQUM7SUFDakIsT0FBTyxFQUFFLElBQUksTUFBQSxFQUFFLE1BQU0sUUFBQSxFQUFFLENBQUM7QUFDekIsQ0FBQztBQUpELG9FQUlDO0FBRUQsU0FBZ0IscUJBQXFCLENBQUMsTUFBb0I7SUFDekQsT0FBTyxJQUFJLFVBQVUsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLFVBQVUsRUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO0FBQzNGLENBQUM7QUFGRCxzREFFQztBQUVELFNBQWdCLFFBQVEsQ0FBQyxNQUFvQjtJQUM1QyxJQUFNLE1BQU0sR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDO0lBQzdCLE1BQU0sQ0FBQyxNQUFNLElBQUksQ0FBQyxDQUFDO0lBQ25CLE9BQU8sTUFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUM7QUFDcEMsQ0FBQztB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O1NBQ2I7UUFDRCwwQkFBZ0IsQ0FBQyxDQUFDO1lBQ2pCLElBQU0sUUFBTSxHQUFHLGVBQWUsQ0FBQyxNQUFNLEVBQUUsS0FBSyxDQUFDLENBQUM7WUFDOUMsSUFBTSxHQUFHLEdBQVEsRUFBRSxDQUFDO1lBRXBCLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxRQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUU7Z0JBQ2hDLElBQU0sUUFBTSxHQUFHLFVBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQztnQkFDbEMsSUFBSSxHQUFHLFNBQUEsQ0FBQztnQkFFUixJQUFJLFFBQU0sRUFBRTtvQkFDWCxHQUFHLEdBQUcsSUFBQSxtQkFBWSxFQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsTUFBTSxDQUFDLE1BQU0sRUFBRSxRQUFNLENBQUUsQ0FBQztvQkFDeEQsTUFBTSxDQUFDLE1BQU0sSUFBSSxRQUFNLENBQUM7b0JBQ3hCLE9BQU8sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7aUJBQ2xCO3FCQUFNO29CQUNOLElBQU0sS0FBSyxHQUFHLFVBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQztvQkFDakMsR0FBRyxHQUFHLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQztpQkFDckI7Z0JBRUQsR0FBRyxDQUFDLEdBQUcsQ0FBQyxHQUFHLE9BQU8sQ0FBQyxNQUFNLEVBQUUsT0FBTyxFQUFFLGdCQUFnQixDQUFDLENBQUM7YUFDdEQ7WUFFRCxPQUFPLEdBQUcsQ0FBQztTQUNYO1FBQ0QsT0FBTyxDQUFDLENBQUMsTUFBTSxJQUFJLEtBQUssQ0FBQywwQkFBbUIsSUFBSSxlQUFLLElBQUksTUFBRyxDQUFDLENBQUM7S0FDOUQ7QUFDRixDQUFDO0FBaEZELDBCQWdGQyIsImZpbGUiOiJwYWNrZXQvYmluYXJ5UmVhZGVyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZGVjb2RlU3RyaW5nIH0gZnJvbSAnLi4vY29tbW9uL3V0ZjgnO1xuaW1wb3J0IHsgU3BlY2lhbCwgVHlwZSwgTnVtYmVyVHlwZSB9IGZyb20gJy4vcGFja2V0Q29tbW9uJztcblxuZXhwb3J0IGludGVyZmFjZSBCaW5hcnlSZWFkZXIge1xuXHR2aWV3OiBEYXRhVmlldztcblx0b2Zmc2V0OiBudW1iZXI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVCaW5hcnlSZWFkZXIoYnVmZmVyOiBVaW50OEFycmF5KTogQmluYXJ5UmVhZGVyIHtcblx0Y29uc3QgdmlldyA9IG5ldyBEYXRhVmlldyhidWZmZXIuYnVmZmVyLCBidWZmZXIuYnl0ZU9mZnNldCwgYnVmZmVyLmJ5dGVMZW5ndGgpO1xuXHRjb25zdCBvZmZzZXQgPSAwO1xuXHRyZXR1cm4geyB2aWV3LCBvZmZzZXQgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUJpbmFyeVJlYWRlckZyb21CdWZmZXIoYnVmZmVyOiBBcnJheUJ1ZmZlciwgYnl0ZU9mZnNldDogbnVtYmVyLCBieXRlTGVuZ3RoOiBudW1iZXIpOiBCaW5hcnlSZWFkZXIge1xuXHRjb25zdCB2aWV3ID0gbmV3IERhdGFWaWV3KGJ1ZmZlciwgYnl0ZU9mZnNldCwgYnl0ZUxlbmd0aCk7XG5cdGNvbnN0IG9mZnNldCA9IDA7XG5cdHJldHVybiB7IHZpZXcsIG9mZnNldCB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0QmluYXJ5UmVhZGVyQnVmZmVyKHJlYWRlcjogQmluYXJ5UmVhZGVyKSB7XG5cdHJldHVybiBuZXcgVWludDhBcnJheShyZWFkZXIudmlldy5idWZmZXIsIHJlYWRlci52aWV3LmJ5dGVPZmZzZXQsIHJlYWRlci52aWV3LmJ5dGVMZW5ndGgpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVhZEludDgocmVhZGVyOiBCaW5hcnlSZWFkZXIpIHtcblx0Y29uc3Qgb2Zmc2V0ID0gcmVhZGVyLm9mZnNldDtcblx0cmVhZGVyLm9mZnNldCArPSAxO1xuXHRyZXR1cm4gcmVhZGVyLnZpZXcuZ2V0SW50OChvZmZzZXQpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVhZFVpbnQ4KHJlYWRlcjogQmluYXJ5UmVhZGVyKSB7XG5cdGNvbnN0IG9mZnNldCA9IHJlYWRlci5vZmZzZXQ7XG5cdHJlYWRlci5vZmZzZXQgKz0gMTtcblx0cmV0dXJuIHJlYWRlci52aWV3LmdldFVpbnQ4KG9mZnNldCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZWFkSW50MTYocmVhZGVyOiBCaW5hcnlSZWFkZXIpIHtcblx0Y29uc3Qgb2Zmc2V0ID0gcmVhZGVyLm9mZnNldDtcblx0cmVhZGVyLm9mZnNldCArPSAyO1xuXHRyZXR1cm4gcmVhZGVyLnZpZXcuZ2V0SW50MTYob2Zmc2V0LCB0cnVlKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlYWRVaW50MTYocmVhZGVyOiBCaW5hcnlSZWFkZXIpIHtcblx0Y29uc3Qgb2Zmc2V0ID0gcmVhZGVyLm9mZnNldDtcblx0cmVhZGVyLm9mZnNldCArPSAyO1xuXHRyZXR1cm4gcmVhZGVyLnZpZXcuZ2V0VWludDE2KG9mZnNldCwgdHJ1ZSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZWFkSW50MzIocmVhZGVyOiBCaW5hcnlSZWFkZXIpIHtcblx0Y29uc3Qgb2Zmc2V0ID0gcmVhZGVyLm9mZnNldDtcblx0cmVhZGVyLm9mZnNldCArPSA0O1xuXHRyZXR1cm4gcmVhZGVyLnZpZXcuZ2V0SW50MzIob2Zmc2V0LCB0cnVlKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlYWRVaW50MzIocmVhZGVyOiBCaW5hcnlSZWFkZXIpIHtcblx0Y29uc3Qgb2Zmc2V0ID0gcmVhZGVyLm9mZnNldDtcblx0cmVhZGVyLm9mZnNldCArPSA0O1xuXHRyZXR1cm4gcmVhZGVyLnZpZXcuZ2V0VWludDMyKG9mZnNldCwgdHJ1ZSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZWFkRmxvYXQzMihyZWFkZXI6IEJpbmFyeVJlYWRlcikge1xuXHRjb25zdCBvZmZzZXQgPSByZWFkZXIub2Zmc2V0O1xuXHRyZWFkZXIub2Zmc2V0ICs9IDQ7XG5cdHJldHVybiByZWFkZXIudmlldy5nZXRGbG9hdDMyKG9mZnNldCwgdHJ1ZSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZWFkRmxvYXQ2NChyZWFkZXI6IEJpbmFyeVJlYWRlcikge1xuXHRjb25zdCBvZmZzZXQgPSByZWFkZXIub2Zmc2V0O1xuXHRyZWFkZXIub2Zmc2V0ICs9IDg7XG5cdHJldHVybiByZWFkZXIudmlldy5nZXRGbG9hdDY0KG9mZnNldCwgdHJ1ZSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZWFkQnl0ZXMocmVhZGVyOiBCaW5hcnlSZWFkZXIsIGxlbmd0aDogbnVtYmVyKSB7XG5cdGNvbnN0IG9mZnNldCA9IHJlYWRlci5vZmZzZXQ7XG5cdHJlYWRlci5vZmZzZXQgKz0gbGVuZ3RoO1xuXHRyZXR1cm4gbmV3IFVpbnQ4QXJyYXkocmVhZGVyLnZpZXcuYnVmZmVyLCByZWFkZXIudmlldy5ieXRlT2Zmc2V0ICsgb2Zmc2V0LCBsZW5ndGgpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVhZEFycmF5QnVmZmVyKHJlYWRlcjogQmluYXJ5UmVhZGVyKSB7XG5cdGNvbnN0IGxlbmd0aCA9IHJlYWRMZW5ndGgocmVhZGVyKTtcblx0aWYgKGxlbmd0aCA9PT0gLTEpIHJldHVybiBudWxsO1xuXG5cdGNvbnN0IG9mZnNldCA9IHJlYWRlci5vZmZzZXQ7XG5cdHJlYWRlci5vZmZzZXQgKz0gbGVuZ3RoO1xuXHRyZXR1cm4gcmVhZGVyLnZpZXcuYnVmZmVyLnNsaWNlKHJlYWRlci52aWV3LmJ5dGVPZmZzZXQgKyBvZmZzZXQsIG9mZnNldCArIGxlbmd0aCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZWFkQm9vbGVhbihyZWFkZXI6IEJpbmFyeVJlYWRlcikge1xuXHRyZXR1cm4gcmVhZFVpbnQ4KHJlYWRlcikgPT09IDE7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZWFkQXJyYXk8VD4ocmVhZGVyOiBCaW5hcnlSZWFkZXIsIHJlYWRPbmU6IChyZWFkZXI6IEJpbmFyeVJlYWRlcikgPT4gVCk6IFRbXSB8IG51bGwge1xuXHRjb25zdCBsZW5ndGggPSByZWFkTGVuZ3RoKHJlYWRlcik7XG5cblx0aWYgKGxlbmd0aCA9PT0gLTEpIHJldHVybiBudWxsO1xuXG5cdGNvbnN0IHJlc3VsdDogVFtdID0gW107XG5cblx0Zm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuXHRcdHJlc3VsdC5wdXNoKHJlYWRPbmUocmVhZGVyKSk7XG5cdH1cblxuXHRyZXR1cm4gcmVzdWx0O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVhZFN0cmluZyhyZWFkZXI6IEJpbmFyeVJlYWRlcikge1xuXHRjb25zdCBsZW5ndGggPSByZWFkTGVuZ3RoKHJlYWRlcik7XG5cdGlmIChsZW5ndGggPT09IC0xKSByZXR1cm4gbnVsbDtcblx0Y29uc3QgcmVzdWx0ID0gZGVjb2RlU3RyaW5nKHJlYWRlci52aWV3LCByZWFkZXIub2Zmc2V0LCBsZW5ndGgpO1xuXHRyZWFkZXIub2Zmc2V0ICs9IGxlbmd0aDtcblx0cmV0dXJuIHJlc3VsdDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlYWRPYmplY3QocmVhZGVyOiBCaW5hcnlSZWFkZXIsIGNsb25lVHlwZWRBcnJheXMgPSBmYWxzZSkge1xuXHRyZXR1cm4gcmVhZEFueShyZWFkZXIsIFtdLCBjbG9uZVR5cGVkQXJyYXlzKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlYWRMZW5ndGgocmVhZGVyOiBCaW5hcnlSZWFkZXIpIHtcblx0bGV0IGxlbmd0aCA9IDA7XG5cdGxldCBzaGlmdCA9IDA7XG5cdGxldCBiID0gMDtcblxuXHRkbyB7XG5cdFx0YiA9IHJlYWRVaW50OChyZWFkZXIpO1xuXHRcdGxlbmd0aCA9IGxlbmd0aCB8ICgoYiAmIDB4N2YpIDw8IHNoaWZ0KTtcblx0XHRzaGlmdCArPSA3O1xuXHR9IHdoaWxlIChiICYgMHg4MCk7XG5cblx0cmV0dXJuIGxlbmd0aCAtIDE7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZWFkVWludDhBcnJheShyZWFkZXI6IEJpbmFyeVJlYWRlcikge1xuXHRjb25zdCBsZW5ndGggPSByZWFkTGVuZ3RoKHJlYWRlcik7XG5cdGlmIChsZW5ndGggPT09IC0xKSByZXR1cm4gbnVsbDtcblx0cmV0dXJuIHJlYWRCeXRlcyhyZWFkZXIsIGxlbmd0aCk7XG59XG5cbmZ1bmN0aW9uIHJlYWRTaG9ydExlbmd0aChyZWFkZXI6IEJpbmFyeVJlYWRlciwgbGVuZ3RoOiBudW1iZXIpIHtcblx0cmV0dXJuIGxlbmd0aCA9PT0gMHgxZiA/IHJlYWRMZW5ndGgocmVhZGVyKSA6IGxlbmd0aDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlYWRBbnkocmVhZGVyOiBCaW5hcnlSZWFkZXIsIHN0cmluZ3M6IHN0cmluZ1tdLCBjbG9uZVR5cGVkQXJyYXlzOiBib29sZWFuKTogYW55IHtcblx0Y29uc3QgYnl0ZSA9IHJlYWRVaW50OChyZWFkZXIpO1xuXHRjb25zdCB0eXBlID0gYnl0ZSAmIDB4ZTA7XG5cdGNvbnN0IHZhbHVlID0gYnl0ZSAmIDB4MWY7XG5cblx0c3dpdGNoICh0eXBlKSB7XG5cdFx0Y2FzZSBUeXBlLlNwZWNpYWw6XG5cdFx0XHRzd2l0Y2ggKHZhbHVlKSB7XG5cdFx0XHRcdGNhc2UgU3BlY2lhbC5VbmRlZmluZWQ6IHJldHVybiB1bmRlZmluZWQ7XG5cdFx0XHRcdGNhc2UgU3BlY2lhbC5OdWxsOiByZXR1cm4gbnVsbDtcblx0XHRcdFx0Y2FzZSBTcGVjaWFsLlRydWU6IHJldHVybiB0cnVlO1xuXHRcdFx0XHRjYXNlIFNwZWNpYWwuRmFsc2U6IHJldHVybiBmYWxzZTtcblx0XHRcdFx0Y2FzZSBTcGVjaWFsLlVpbnQ4QXJyYXk6IHtcblx0XHRcdFx0XHRjb25zdCB2YWx1ZSA9IHJlYWRVaW50OEFycmF5KHJlYWRlcik7XG5cdFx0XHRcdFx0aWYgKHZhbHVlICYmIGNsb25lVHlwZWRBcnJheXMpIHJldHVybiB2YWx1ZS5zbGljZSgpO1xuXHRcdFx0XHRcdHJldHVybiB2YWx1ZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRkZWZhdWx0OiB0aHJvdyBuZXcgRXJyb3IoYEluY29ycmVjdCB2YWx1ZSAoJHt2YWx1ZX0sICR7Ynl0ZX0pYCk7XG5cdFx0XHR9XG5cdFx0Y2FzZSBUeXBlLk51bWJlcjpcblx0XHRcdHN3aXRjaCAodmFsdWUpIHtcblx0XHRcdFx0Y2FzZSBOdW1iZXJUeXBlLkludDg6IHJldHVybiByZWFkSW50OChyZWFkZXIpO1xuXHRcdFx0XHRjYXNlIE51bWJlclR5cGUuVWludDg6IHJldHVybiByZWFkVWludDgocmVhZGVyKTtcblx0XHRcdFx0Y2FzZSBOdW1iZXJUeXBlLkludDE2OiByZXR1cm4gcmVhZEludDE2KHJlYWRlcik7XG5cdFx0XHRcdGNhc2UgTnVtYmVyVHlwZS5VaW50MTY6IHJldHVybiByZWFkVWludDE2KHJlYWRlcik7XG5cdFx0XHRcdGNhc2UgTnVtYmVyVHlwZS5JbnQzMjogcmV0dXJuIHJlYWRJbnQzMihyZWFkZXIpO1xuXHRcdFx0XHRjYXNlIE51bWJlclR5cGUuVWludDMyOiByZXR1cm4gcmVhZFVpbnQzMihyZWFkZXIpO1xuXHRcdFx0XHRjYXNlIE51bWJlclR5cGUuRmxvYXQzMjogcmV0dXJuIHJlYWRGbG9hdDMyKHJlYWRlcik7XG5cdFx0XHRcdGNhc2UgTnVtYmVyVHlwZS5GbG9hdDY0OiByZXR1cm4gcmVhZEZsb2F0NjQocmVhZGVyKTtcblx0XHRcdFx0ZGVmYXVsdDogdGhyb3cgbmV3IEVycm9yKGBJbmNvcnJlY3QgdmFsdWUgKCR7dmFsdWV9LCAke2J5dGV9KWApO1xuXHRcdFx0fVxuXHRcdGNhc2UgVHlwZS5UaW55UG9zaXRpdmVOdW1iZXI6XG5cdFx0XHRyZXR1cm4gdmFsdWU7XG5cdFx0Y2FzZSBUeXBlLlRpbnlOZWdhdGl2ZU51bWJlcjpcblx0XHRcdHJldHVybiAtKHZhbHVlICsgMSk7XG5cdFx0Y2FzZSBUeXBlLlN0cmluZzoge1xuXHRcdFx0Y29uc3QgbGVuZ3RoID0gcmVhZFNob3J0TGVuZ3RoKHJlYWRlciwgdmFsdWUpO1xuXHRcdFx0Y29uc3QgcmVzdWx0ID0gZGVjb2RlU3RyaW5nKHJlYWRlci52aWV3LCByZWFkZXIub2Zmc2V0LCBsZW5ndGgpITtcblx0XHRcdHJlYWRlci5vZmZzZXQgKz0gbGVuZ3RoO1xuXHRcdFx0c3RyaW5ncy5wdXNoKHJlc3VsdCk7XG5cdFx0XHRyZXR1cm4gcmVzdWx0O1xuXHRcdH1cblx0XHRjYXNlIFR5cGUuU3RyaW5nUmVmOiB7XG5cdFx0XHRjb25zdCBpbmRleCA9IHJlYWRTaG9ydExlbmd0aChyZWFkZXIsIHZhbHVlKTtcblx0XHRcdHJldHVybiBzdHJpbmdzW2luZGV4XTtcblx0XHR9XG5cdFx0Y2FzZSBUeXBlLkFycmF5OiB7XG5cdFx0XHRjb25zdCBsZW5ndGggPSByZWFkU2hvcnRMZW5ndGgocmVhZGVyLCB2YWx1ZSk7XG5cdFx0XHRjb25zdCBhcnJheTogYW55W10gPSBbXTtcblxuXHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuXHRcdFx0XHRhcnJheS5wdXNoKHJlYWRBbnkocmVhZGVyLCBzdHJpbmdzLCBjbG9uZVR5cGVkQXJyYXlzKSk7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBhcnJheTtcblx0XHR9XG5cdFx0Y2FzZSBUeXBlLk9iamVjdDoge1xuXHRcdFx0Y29uc3QgbGVuZ3RoID0gcmVhZFNob3J0TGVuZ3RoKHJlYWRlciwgdmFsdWUpO1xuXHRcdFx0Y29uc3Qgb2JqOiBhbnkgPSB7fTtcblxuXHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuXHRcdFx0XHRjb25zdCBsZW5ndGggPSByZWFkTGVuZ3RoKHJlYWRlcik7XG5cdFx0XHRcdGxldCBrZXk7XG5cblx0XHRcdFx0aWYgKGxlbmd0aCkge1xuXHRcdFx0XHRcdGtleSA9IGRlY29kZVN0cmluZyhyZWFkZXIudmlldywgcmVhZGVyLm9mZnNldCwgbGVuZ3RoKSE7XG5cdFx0XHRcdFx0cmVhZGVyLm9mZnNldCArPSBsZW5ndGg7XG5cdFx0XHRcdFx0c3RyaW5ncy5wdXNoKGtleSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Y29uc3QgaW5kZXggPSByZWFkTGVuZ3RoKHJlYWRlcik7XG5cdFx0XHRcdFx0a2V5ID0gc3RyaW5nc1tpbmRleF07XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRvYmpba2V5XSA9IHJlYWRBbnkocmVhZGVyLCBzdHJpbmdzLCBjbG9uZVR5cGVkQXJyYXlzKTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIG9iajtcblx0XHR9XG5cdFx0ZGVmYXVsdDogdGhyb3cgbmV3IEVycm9yKGBJbmNvcnJlY3QgdHlwZSAoJHt0eXBlfSwgJHtieXRlfSlgKTtcblx0fVxufVxuIl0sInNvdXJjZVJvb3QiOiIvaG9tZS9hbHBoYS9EZXNrdG9wL2Rldi90Yy1zb2NrZXRzL3NyYyJ9
